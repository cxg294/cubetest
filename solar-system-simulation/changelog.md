# 太阳系模拟系统 - 更新日志

## 2024-07-18 版本更新

### 功能修复
- 修复轨道形状查询响应功能
  - 修复询问"行星轨道都是圆的吗？"无法切换到俯视图的问题
  - 添加setTopView函数实现模块间通信
  - 优化相机动画，实现平滑俯视视角切换
  - 确保完整观察所有行星椭圆轨道

## 2024-07-17 版本更新 (2)

### 视觉效果增强
- 大幅提升太阳中心光源效果
  - 太阳点光源强度提高到原来的2.5倍(从200到500)
  - 太阳照射范围扩大60%(从500到800)
  - 优化太阳系整体光照平衡和层次感

## 2024-07-17 版本更新

### 视觉效果增强
- 提升太阳系整体光照效果
  - 环境光强度提高150%，提升整体场景亮度
  - 太阳点光源强度提高50%，增强中心光源效果
  - 辅助光源强度提高60%，改善行星背面光照
  - 太阳光照射范围扩大，提升远距离行星照明

## 2024-07-16 版本更新

### 功能修复
- 修复月球缺失问题
  - 为动画循环添加月球位置更新逻辑
  - 实现月球围绕地球的准确轨道运动
  - 支持开普勒轨道参数(半长轴、偏心率、轨道倾角)
  - 保持月球同步自转

## 2024-07-15 版本更新

### 视觉效果增强
- 添加太阳日冕效果
  - 实现双层日冕发光效果
  - 内外层光晕具有不同强度和透明度
  - 使用加性混合实现真实的太阳光晕
- 增强地球大气层效果
  - 实现蓝色大气层和外层辉光
  - 优化云层渲染效果和质量
  - 提高日夜交界线的真实感

## 2024-07-14 资源探索 (更新)

### 研究进展
- 行星大气层效果研究
  - 更新多个可靠的替代贴图资源站点
  - NASA科学可视化工作室(https://svs.gsfc.nasa.gov/)作为首选替代资源
  - 添加了多个可在国内访问的材质资源网站
  - 包含Three.js官方仓库贴图资源链接

## 2024-07-13 版本更新

### 用户界面优化
- 行星知识卡片布局改进
  - 移除固定高度限制，改为自适应内容高度
  - 取消内容滚动条，完整显示所有行星信息
  - 保持整体设计风格不变

## 2024-07-12 版本更新

### 界面改进
- 星球轨道颜色优化
  - 将轨道颜色从蓝色改为带透明度的白色
  - 降低轨道线的不透明度，使其更加柔和
- 添加还原视图功能
  - 在控制面板添加"还原视图"按钮
  - 一键重置相机位置和视角
  - 恢复行星自转和公转
  - 重置模拟速度为默认值

## 2024-07-11 版本更新

### 错误修复
- 修复了行星标签与行星位置不对齐的问题
  - 标签渲染器(CSS2DRenderer)尺寸现在正确设置为左侧70%宽度，而不是整个窗口宽度
  - 添加了明确的left = '0'样式，确保标签渲染器位置正确
  - 保证窗口大小调整时标签渲染器尺寸同步更新

## 2024-07-10 版本更新

### 用户体验提升
- 增强聊天区域智能答疑功能
  - 添加对"行星轨道形状"相关问题的自动识别
  - 提供科学详实的轨道形状解释和数据
  - 实现问答触发的专业视角切换功能

### 视角控制优化
- 新增太阳系俯视视角功能
  - 自动识别特定问题后触发视角转换
  - 实现从任意角度到俯视视角的平滑过渡
  - 优化观察轨道形状的最佳视角
  
### 技术实现
- 使用过滤算法提高聊天文本识别精度
- 实现相机动画系统，确保视角切换流畅自然
- 增强代码模块化，提高功能扩展性

## 2024-07-09 版本更新

### 用户界面优化
- 压缩知识卡片布局，减少对星球视图的遮挡
  - 最大高度限制为160px并添加垂直滚动
  - 减小文本行高和元素间距
  - 短字段合并到同一行显示，节省空间
  - 描述文本区域高度限制为50px，内部可滚动

### 交互体验增强
- 改进星球选择功能
  - 选中星球时临时隐藏所有轨道线，使星球更突出
  - 取消选择时自动恢复轨道线显示
  - 选中星球时增加其自转速度(3倍原速)，旋转效果更明显
  - 缩小相机与星球间距离，放大星球视图

## 2024-07-08 版本更新

### 错误修复
- 修复了代码中的重复`easeInOutCubic`函数声明问题
- 添加了favicon链接，解决404错误
- 修复了`isARMode`变量未定义的错误
- 解决了行星标签与行星位置不对齐的问题
  - 修正了鼠标坐标计算，确保检测到正确的行星位置
  - 调整了标签渲染逻辑，使标签与行星对齐

### 界面布局优化
- 重构了整体布局设计
  - 行星信息面板从右侧移至页面底部
  - 行星选择按钮从底部移至左侧垂直排列
  - 太阳系渲染区域调整为占左侧70%宽度，聊天区占右侧30%
- 改进用户界面交互
  - 用户输入框高度增加到原来的4倍以上
  - 增大聊天区域所有文本的字号，提高可读性
  - 将左上角标题从"太阳系模拟"改为"太阳系模拟系统"
  - 为聊天消息添加头像（系统消息显示"AI"，用户消息显示"我"）
- 视觉效果增强
  - 增强行星轨道线的可见性，将颜色改为蓝色并增加不透明度
  - 简化控制面板，删除了"开启/关闭太阳脉动"按钮

### 技术改进
- 渲染区域优化
  - 使用Three.js的setViewport方法调整WebGL渲染区域
  - 修改CSS2D标签渲染器的宽度，确保标签位置正确
- 坐标计算修正
  - 更新鼠标标准化设备坐标计算公式，考虑左侧70%的渲染区域
  - 优化raycasting检测逻辑，确保准确选中行星 